# Testing with Database Connections

Databases are very important tools for engineers to be familiar with and leverage correctly. Understanding how to properly test your code that works with databases will allow you to ensure that your application works correctly under all cases. Databases are especially tricky because they manage state that changes over time and the data lives outside of the application process memory so the logic we write must be very robust to be able to deal with any changes that may come.

In our exercises below, we will explore a few different databases and the options we have in testing them:

1. SQLite
2. MongoDB

## Needed Tools

1. Version Control
2. Programming Language/Platform
3. Linter
4. Test Harness
5. Code Coverage Tool
6. Databases

## Setup

1. Ensure that `node >= 8.6` is installed
2. Run `npm install`
3. Run `npm test`, you should expect to see all tests passing and some code coverage
4. Run `npm run report` to see the coverage reports
5. Run `npm run test:watch` to have tests automatically rerun when changes are made

## Exercise

### Goals

Our goals in the following exercise are:

1. Learn how to reach 100% coverage on lines and branches for code that needs to access the database.
2. Learn how to test in and out of memory databases
3. Learn how to test SQL and no-SQL databases
4. Get hands on practice with a modern testing harness, tools, and techniques

### Steps

In order to achieve these goals, we will follow these steps:

1. Familiarize yourself with the coverage report by looking at the web page generated by `npm run report`. You can simply refresh the web page after running your tests to see the updated coverage.
2. Familiarize yourself with the test watcher by running `npm run test:watch` and making a change to a file or pressing `rs` and watching the linter and tests be rerun.
3. Aim for 100% line and branch coverage of the logic in `src/sqlite.js` by adding tests to `tests/sqlite.test.js`
4. Aim for 100% line and branch coverage of the logic in `src/mongo.js` by adding tests to `tests/mongo.test.js`

### Conclusion

Congratulations! You've just finished the testing exercise related to databases. We've learned in this exercise the difference between testing in memory and out of memory databases. We've also tested both a SQL and no-SQL flavor database.